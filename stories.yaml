# Google Contacts Project - User Stories
# This file includes both:
# - Stories for aligning email-manager to golang skill conventions
# - Stories for the new google-contacts application
#
# Credentials Strategy: Duplicated auth code with unified scopes
# Both applications have their own pkg/auth/ with IDENTICAL code containing:
# - Gmail scopes (for email-manager)
# - Contacts scopes (for google-contacts)
# Both use the same token file: ~/.credentials/google_token.json
# This ensures single OAuth consent for both apps.

# =============================================================================
# PHASE 1: EMAIL-MANAGER ALIGNMENT (to golang skill structure)
# =============================================================================

- id: US-00001
  title: "email-manager: Restructure to golang skill layout"
  priority: 1
  description: |
    Restructure email-manager project to follow golang skill conventions.

    Current structure (non-standard):
    ```
    email-manager/
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ main.go
    â”‚   â”œâ”€â”€ cli.go
    â”‚   â”œâ”€â”€ auth.go
    â”‚   â”œâ”€â”€ go.mod
    â”‚   â””â”€â”€ go.sum
    ```

    Target structure (golang skill compliant):
    ```
    email-manager/
    â”œâ”€â”€ go.mod              # Module at root
    â”œâ”€â”€ go.sum
    â”œâ”€â”€ cmd/
    â”‚   â””â”€â”€ email-manager/
    â”‚       â””â”€â”€ main.go     # Entry point only
    â”œâ”€â”€ internal/
    â”‚   â”œâ”€â”€ cli/
    â”‚   â”‚   â””â”€â”€ cli.go      # CLI commands
    â”‚   â””â”€â”€ gmail/
    â”‚       â””â”€â”€ service.go  # Gmail API service
    â””â”€â”€ pkg/
        â””â”€â”€ auth/
            â””â”€â”€ auth.go     # OAuth2 authentication (will be duplicated)
    ```

    Acceptance criteria:
    - go.mod moved to project root with correct module path
    - Entry point in cmd/email-manager/main.go (minimal, just wiring)
    - Business logic in internal/ packages
    - Auth code in pkg/auth/ (prepared for duplication to google-contacts)
    - All existing functionality preserved
    - make build && make test pass
  tests:
  - go.mod exists at project root (not in src/)
  - cmd/email-manager/main.go exists and is minimal entry point
  - internal/cli/cli.go exists with command implementations
  - internal/gmail/service.go exists with Gmail service logic
  - pkg/auth/auth.go exists with OAuth2 logic
  - src/ directory no longer exists
  - make clean && make build succeeds
  - ./bin/email-manager --help shows usage
  - all existing commands still work (send, list, get, search, etc.)
  passes: true

- id: US-00002
  title: "email-manager: Add People API scopes for unified credentials"
  priority: 2
  description: |
    Extend email-manager OAuth2 configuration to include Google People API scopes.
    This enables a single OAuth consent for both email-manager and google-contacts.

    Current scopes (Gmail only):
    - gmail.GmailModifyScope
    - gmail.GmailSendScope
    - gmail.GmailLabelsScope

    New scopes to add (People API):
    - people.ContactsScope (read/write contacts)
    - people.ContactsOtherReadonlyScope (read other contacts)

    IMPORTANT: Adding new scopes will require user re-authorization.
    The token file should be deleted to force re-auth with combined scopes.

    The pkg/auth/auth.go will contain ALL scopes (Gmail + Contacts) so that:
    - email-manager uses Gmail scopes from the unified token
    - google-contacts uses Contacts scopes from the same token
    - User only authorizes once for both apps

    Acceptance criteria:
    - People API scopes added to pkg/auth/auth.go
    - Token file path remains ~/.credentials/google_token.json
    - Re-authorization flow works correctly
    - Gmail functionality still works after re-auth
  tests:
  - pkg/auth/auth.go includes people.ContactsScope
  - pkg/auth/auth.go includes people.ContactsOtherReadonlyScope
  - make build succeeds
  - after deleting token, re-auth prompts for Gmail AND Contacts permissions
  - email-manager list command works after re-auth
  passes: true

# =============================================================================
# PHASE 2: GOOGLE-CONTACTS PROJECT INITIALIZATION
# =============================================================================

- id: US-00003
  title: "google-contacts: Project initialization with duplicated auth"
  priority: 3
  description: |
    Initialize the google-contacts project following golang skill conventions.
    Duplicate the auth code from email-manager (pkg/auth/auth.go).

    Project structure:
    ```
    google-contacts/
    â”œâ”€â”€ go.mod
    â”œâ”€â”€ go.sum
    â”œâ”€â”€ Makefile
    â”œâ”€â”€ README.md
    â”œâ”€â”€ CLAUDE.md
    â”œâ”€â”€ .gitignore
    â”œâ”€â”€ cmd/
    â”‚   â””â”€â”€ google-contacts/
    â”‚       â””â”€â”€ main.go
    â”œâ”€â”€ internal/
    â”‚   â””â”€â”€ cli/
    â”‚       â””â”€â”€ cli.go
    â””â”€â”€ pkg/
        â””â”€â”€ auth/
            â””â”€â”€ auth.go     # DUPLICATED from email-manager (identical)
    ```

    The pkg/auth/auth.go must be IDENTICAL to email-manager's version:
    - Same scopes (Gmail + Contacts)
    - Same token file path (~/.credentials/google_token.json)
    - Same credentials file path (~/.credentials/google_credentials.json)

    Features:
    - Cobra CLI framework
    - Basic --help and --version commands
    - Git repository initialized
    - GitHub repository created (smorand/google-contacts, public)

    Acceptance criteria:
    - Project compiles and runs
    - pkg/auth/auth.go is identical to email-manager's version
    - --help shows usage information
    - --version shows version string
    - Git initialized with initial commit
    - GitHub repo created and pushed
  tests:
  - go.mod exists at project root
  - cmd/google-contacts/main.go exists
  - internal/cli/cli.go exists with root command
  - pkg/auth/auth.go exists and matches email-manager version
  - Makefile exists with build, test, clean targets
  - README.md exists with project description
  - CLAUDE.md exists for AI interactions
  - .gitignore exists with Go patterns
  - make clean && make build succeeds
  - ./bin/google-contacts --help shows usage
  - ./bin/google-contacts --version shows version
  - git log shows initial commit
  - gh repo view smorand/google-contacts succeeds
  passes: true

- id: US-00004
  title: "google-contacts: People API service initialization"
  priority: 4
  description: |
    Implement Google People API service initialization using the duplicated auth.

    Implementation:
    - Import auth package from local pkg/auth
    - Create People API service wrapper in internal/contacts/
    - Handle authentication errors gracefully
    - Test connection with a simple API call

    The service should be created lazily on first command execution,
    not at application startup.

    File structure:
    ```
    internal/
    â””â”€â”€ contacts/
        â””â”€â”€ service.go    # People API service wrapper
    ```

    Acceptance criteria:
    - People API service can be created
    - Auth flow works (browser opens for first-time auth if no token)
    - If token exists (from email-manager), no re-auth needed
    - Proper error messages for auth failures
  tests:
  - internal/contacts/service.go exists
  - GetPeopleService(ctx) function is implemented
  - make build succeeds
  - if token exists from email-manager, no auth prompt appears
  - if no token, running any command triggers auth flow
  passes: true

# =============================================================================
# PHASE 3: GOOGLE-CONTACTS CORE FEATURES
# =============================================================================

- id: US-00005
  title: "google-contacts: Create contact command"
  priority: 5
  description: |
    Implement the 'create' command to add new contacts.

    Command: google-contacts create [flags]

    Required flags:
    - --firstname, -f: First name (required)
    - --lastname, -l: Last name (required)
    - --phone, -p: Phone number (required)

    Important flags:
    - --company, -c: Company name (highly recommended)

    Optional flags:
    - --email, -e: Email address
    - --position, -r: Role/position at company
    - --notes, -n: Notes about the contact

    Output:
    - Success: Display created contact ID and summary
    - Error: Clear error message

    Acceptance criteria:
    - Contact created in Google Contacts
    - All fields properly mapped to People API
    - Phone number formatted correctly
    - Returns contact ID for reference
  tests:
  - google-contacts create --help shows all flags
  - create with only required fields succeeds
  - create with all fields succeeds
  - create without required fields shows error
  - created contact visible in Google Contacts web UI
  - output shows contact ID
  passes: true

- id: US-00006
  title: "google-contacts: Search contacts command"
  priority: 6
  description: |
    Implement the 'search' command to find contacts.

    Command: google-contacts search <query>

    Search capabilities:
    - By name (partial match)
    - By email (partial match)
    - By phone number
    - By company name

    Output behavior:
    - Multiple results: Show list with main info (name, phone, company, email)
    - Single result: Show full contact details automatically
    - No results: Clear message

    List format (multiple results):
    ```
    ID          | Name           | Phone        | Company    | Email
    c123456789  | John Doe       | +33612345678 | Acme Inc   | john@acme.com
    c987654321  | John Smith     | +33698765432 | Tech Corp  | john@tech.com
    ```

    Acceptance criteria:
    - Search by any field works
    - Partial matches supported
    - Single result shows full details
    - Multiple results show summary list
  tests:
  - google-contacts search --help shows usage
  - search by name returns matching contacts
  - search by partial name works
  - search by email works
  - search by phone works
  - search by company works
  - single result displays full info
  - multiple results display summary list
  - no results shows appropriate message
  passes: true

- id: US-00007
  title: "google-contacts: Show contact details command"
  priority: 7
  description: |
    Implement the 'show' command to display full contact information.

    Command: google-contacts show <contact-id>

    The contact ID is the Google Contact resource name (e.g., "people/c123456789")
    or just the ID part ("c123456789").

    Full information display:
    - Name (first, last)
    - All phone numbers (with labels: mobile, work, home)
    - All email addresses (with labels)
    - Company and position
    - Notes
    - Google Contact ID
    - Creation/modification dates (if available)

    Format: Human-readable, possibly with colors for labels.

    Acceptance criteria:
    - Contact retrieved by ID
    - All available fields displayed
    - Clear formatting with labels
    - Error if contact not found
  tests:
  - google-contacts show --help shows usage
  - show with valid ID displays full contact
  - show displays all phone numbers with labels
  - show displays all emails with labels
  - show displays company and position
  - show displays notes
  - show with invalid ID shows error
  passes: true

# =============================================================================
# PHASE 4: POLISH AND DOCUMENTATION
# =============================================================================

- id: US-00008
  title: "google-contacts: Complete documentation"
  priority: 8
  description: |
    Finalize all project documentation.

    README.md should include:
    - Project description and purpose
    - Prerequisites (Go, Google Cloud project, credentials)
    - Installation instructions
    - Configuration (credentials setup)
    - Usage examples for all commands
    - Explanation of credential sharing with email-manager
    - Note about unified scopes and single OAuth consent

    CLAUDE.md should include:
    - Project structure overview
    - Key files and their purposes
    - Common development tasks
    - Testing instructions
    - API integration details
    - Note about duplicated auth code and why

    Acceptance criteria:
    - README.md is complete and accurate
    - CLAUDE.md enables efficient AI collaboration
    - All commands documented with examples
  tests:
  - README.md contains installation instructions
  - README.md contains usage examples for create, search, show
  - README.md explains credential setup
  - README.md explains credential sharing with email-manager
  - CLAUDE.md contains project structure
  - CLAUDE.md contains development workflow
  - CLAUDE.md mentions duplicated auth code rationale
  passes: true

- id: US-00009
  title: "google-contacts: Unit tests"
  priority: 9
  description: |
    Implement unit tests for core functionality.

    Test coverage:
    - CLI argument parsing
    - Contact field validation
    - Phone number formatting
    - Search query handling
    - Error handling paths

    Use standard library testing (if + t.Errorf pattern).
    Mock external API calls for unit tests.

    Acceptance criteria:
    - Tests cover main code paths
    - make test passes
    - No external API calls in unit tests
  tests:
  - internal/cli/cli_test.go exists
  - internal/contacts/service_test.go exists
  - make test passes with no errors
  - tests run without network calls
  passes: true

# =============================================================================
# PHASE 5: GOOGLE-CONTACTS SKILL CREATION
# =============================================================================

- id: US-00010
  title: "google-contacts: Create skill in ~/.claude/skills"
  priority: 10
  description: |
    Create a new google-contacts skill in the global Claude skills directory.
    This skill will allow Claude to interact with Google Contacts via the CLI.

    Skill structure:
    ```
    ~/.claude/skills/google-contacts/
    â”œâ”€â”€ SKILL.md           # Main skill definition with commands and usage
    â””â”€â”€ scripts/
        â””â”€â”€ google-contacts  # Symlink to installed binary
    ```

    The SKILL.md should include:
    - Skill metadata (name, description, trigger phrases)
    - Available commands (create, search, show)
    - Usage examples for each command
    - Screenshot processing workflow
    - Integration with existing CLI

    Trigger phrases (when to use this skill):
    - "Create a contact"
    - "Add a new contact"
    - "Search for contact"
    - "Find contact"
    - "Show contact details"
    - "Get contact info"
    - "Create contact from screenshot"

    Acceptance criteria:
    - Skill directory created at ~/.claude/skills/google-contacts/
    - SKILL.md defines all commands and usage patterns
    - Symlink to binary works correctly
    - Skill is recognized by Claude
  tests:
  - ~/.claude/skills/google-contacts/ directory exists
  - ~/.claude/skills/google-contacts/SKILL.md exists
  - SKILL.md has proper frontmatter (name, description)
  - SKILL.md documents create, search, show commands
  - scripts/google-contacts symlink points to correct binary
  - skill is accessible via Claude's Skill tool
  passes: true

- id: US-00011
  title: "google-contacts skill: Create contact from basic information"
  priority: 11
  description: |
    Document and enable creating contacts from basic information.

    The skill should handle natural language requests like:
    - "Create a contact for John Doe, phone +33612345678, at Acme Corp"
    - "Add contact: Marie Dupont, 0612345678, marie@example.com"
    - "New contact Jean Martin from TechCorp, +33612345678, CTO"

    Skill workflow:
    1. Parse user request to extract: first name, last name, phone, email, company, position
    2. Validate required fields (first name, last name, phone)
    3. Execute google-contacts create command with extracted values
    4. Return confirmation with contact ID

    SKILL.md should include:
    - Natural language parsing examples
    - Command construction patterns
    - Error handling for missing required fields

    Acceptance criteria:
    - SKILL.md documents natural language parsing for contact creation
    - Examples cover various input formats
    - Required vs optional fields clearly documented
  tests:
  - SKILL.md contains create contact workflow
  - SKILL.md shows examples of natural language parsing
  - SKILL.md documents required fields (first name, last name, phone)
  - SKILL.md documents optional fields (email, company, position, notes)
  passes: true

- id: US-00012
  title: "google-contacts skill: Create contact from screenshot"
  priority: 12
  description: |
    Document workflow for creating contacts from screenshots of business cards,
    email signatures, or any image containing contact information.

    Workflow:
    1. User provides screenshot path or says "from this screenshot"
    2. Claude reads the image file using the Read tool
    3. Claude extracts contact information from the image (name, phone, email, company, position)
    4. Claude confirms extracted data with user
    5. Claude executes google-contacts create command
    6. Return confirmation with contact ID

    SKILL.md should include:
    - Screenshot reading workflow using Read tool
    - Data extraction patterns from images
    - Confirmation step before creation
    - Common image sources (business cards, email signatures, LinkedIn)

    User requests:
    - "Create contact from this screenshot: /path/to/image.png"
    - "Add the contact from this business card"
    - "Extract contact from ~/Downloads/screenshot.png and add it"

    Acceptance criteria:
    - SKILL.md documents screenshot workflow
    - Examples show image path handling
    - Confirmation step is included before creation
    - Handles various image sources
  tests:
  - SKILL.md contains screenshot workflow section
  - SKILL.md shows how to use Read tool for images
  - SKILL.md documents confirmation step
  - SKILL.md handles ~/Downloads/ paths
  passes: true

- id: US-00013
  title: "google-contacts skill: Search and retrieve contacts"
  priority: 13
  description: |
    Document workflow for searching and retrieving contact information.

    Search scenarios:
    - "Find contact John" -> search by name
    - "Search for contacts at Acme Corp" -> search by company
    - "Who has phone number 0612345678" -> search by phone
    - "Show me John Doe's contact" -> search + show if single result

    SKILL.md should include:
    - Search command usage
    - Handling single vs multiple results
    - Auto-show for single results
    - Show command for detailed view

    Show scenarios:
    - "Show contact details for c123456789"
    - "Get full info for John Doe" (after search)
    - "What's John's phone number" -> search + extract specific field

    Acceptance criteria:
    - SKILL.md documents search workflow
    - SKILL.md documents show command
    - Examples for single and multiple results
    - Field extraction from results documented
  tests:
  - SKILL.md contains search workflow section
  - SKILL.md contains show command section
  - SKILL.md handles single result auto-show
  - SKILL.md shows field extraction examples
  passes: true

# =============================================================================
# PHASE 6: ENHANCED FEATURES & SKILL IMPROVEMENTS
# =============================================================================

- id: US-00014
  title: "google-contacts: Delete contact command"
  priority: 14
  description: |
    Implement the 'delete' command to remove contacts.

    Command: google-contacts delete <contact-id>

    The contact ID is the Google Contact resource name (e.g., "people/c123456789")
    or just the ID part ("c123456789").

    Safety features:
    - Display contact summary before deletion
    - Require --force flag for immediate deletion
    - Without --force, prompt for confirmation (Y/n)

    Flags:
    - --force, -f: Skip confirmation prompt

    Output:
    - Success: Display deleted contact summary
    - Error: Clear error message if contact not found

    Implementation:
    - Add DeleteContact method to internal/contacts/service.go
    - Add delete command to internal/cli/cli.go
    - Use People API DeleteContact method

    Acceptance criteria:
    - Contact deleted from Google Contacts
    - Confirmation required unless --force used
    - Clear error if contact not found
    - Contact no longer visible in Google Contacts web UI after deletion
  tests:
  - google-contacts delete --help shows usage
  - delete without ID shows error
  - delete with invalid ID shows appropriate error
  - delete with valid ID prompts for confirmation
  - delete with --force skips confirmation
  - deleted contact no longer appears in search results
  - deleted contact no longer visible in Google Contacts web UI
  passes: true

- id: US-00015
  title: "google-contacts: Update contact command"
  priority: 15
  description: |
    Implement the 'update' command to modify existing contacts.

    Command: google-contacts update <contact-id> [flags]

    The contact ID is the Google Contact resource name (e.g., "people/c123456789")
    or just the ID part ("c123456789").

    Flags (all optional, only specified fields are updated):
    - --firstname, -f: Update first name
    - --lastname, -l: Update last name
    - --phone, -p: Update primary phone (replaces first phone)
    - --email, -e: Update primary email (replaces first email)
    - --company, -c: Update company name
    - --position, -r: Update role/position
    - --notes, -n: Update notes

    Behavior:
    - Fetch current contact data first
    - Merge specified changes with existing data
    - Only modify fields that are explicitly provided
    - Display updated contact summary

    Implementation:
    - Add UpdateContact method to internal/contacts/service.go
    - Add update command to internal/cli/cli.go
    - Use People API updateContact method with updatePersonFields

    Acceptance criteria:
    - Contact updated in Google Contacts
    - Only specified fields are modified
    - Unspecified fields remain unchanged
    - Updated contact visible with new data in Google Contacts web UI
  tests:
  - google-contacts update --help shows all flags
  - update without ID shows error
  - update with only --firstname updates only first name
  - update with multiple flags updates multiple fields
  - update preserves unspecified fields
  - updated contact visible in Google Contacts web UI with changes
  passes: true

- id: US-00016
  title: "google-contacts: Multiple phones support in create/update"
  priority: 16
  description: |
    Add support for multiple phone numbers with types (labels) in create and update commands.

    Phone types supported:
    - mobile: Mobile phone (default if no type specified)
    - work: Work phone
    - home: Home phone
    - main: Main phone
    - other: Other phone

    Syntax for --phone flag:
    - Single phone: --phone "+33612345678" (type defaults to mobile)
    - Phone with type: --phone "mobile:+33612345678"
    - Multiple phones: --phone "mobile:+33612345678" --phone "work:+33123456789"

    For create command:
    - Accept multiple --phone flags
    - Parse type:number format
    - Default to "mobile" if no type prefix

    For update command:
    - --phone replaces all existing phones
    - --add-phone adds a new phone without removing existing ones
    - --remove-phone removes a specific phone by value

    Additional flags for update:
    - --add-phone: Add a phone number (can be repeated)
    - --remove-phone: Remove a phone number by value (can be repeated)

    Implementation:
    - Modify ContactInput struct to support []PhoneEntry
    - Update create command to parse multiple phones
    - Add phone management flags to update command
    - Update service methods to handle multiple phones

    Acceptance criteria:
    - Create command accepts multiple phones with types
    - Update command can add/remove individual phones
    - Phone types are correctly saved in Google Contacts
    - All phones visible with correct labels in show command
  tests:
  - create with single phone works (defaults to mobile)
  - create with typed phone works (e.g., work:+33123456789)
  - create with multiple phones works
  - show displays all phones with correct types
  - update --phone replaces all phones
  - update --add-phone adds without removing
  - update --remove-phone removes specific phone
  - Google Contacts web UI shows all phones with correct labels
  passes: true

- id: US-00017
  title: "google-contacts: Multiple emails support in create/update"
  priority: 17
  description: |
    Add support for multiple email addresses with types (labels) in create and update commands.

    Email types supported:
    - work: Work email (default if no type specified)
    - home: Personal email
    - other: Other email

    Syntax for --email flag:
    - Single email: --email "john@acme.com" (type defaults to work)
    - Email with type: --email "work:john@acme.com"
    - Multiple emails: --email "work:john@acme.com" --email "home:john@gmail.com"

    For create command:
    - Accept multiple --email flags
    - Parse type:value format
    - Default to "work" if no type prefix

    For update command:
    - --email replaces all existing emails
    - --add-email adds a new email without removing existing ones
    - --remove-email removes a specific email by value

    Additional flags for update:
    - --add-email: Add an email address (can be repeated)
    - --remove-email: Remove an email address by value (can be repeated)

    Implementation:
    - Modify ContactInput struct to support []EmailEntry
    - Update create command to parse multiple emails
    - Add email management flags to update command
    - Update service methods to handle multiple emails

    Acceptance criteria:
    - Create command accepts multiple emails with types
    - Update command can add/remove individual emails
    - Email types are correctly saved in Google Contacts
    - All emails visible with correct labels in show command
  tests:
  - create with single email works (defaults to work)
  - create with typed email works (e.g., home:john@gmail.com)
  - create with multiple emails works
  - show displays all emails with correct types
  - update --email replaces all emails
  - update --add-email adds without removing
  - update --remove-email removes specific email
  - Google Contacts web UI shows all emails with correct labels
  passes: true

# =============================================================================
# PHASE 7: SKILL IMPROVEMENTS - NAME RECOGNITION & VALIDATION
# =============================================================================

- id: US-00018
  title: "google-contacts skill: Name recognition improvements"
  priority: 18
  description: |
    Improve the skill's ability to correctly identify first name vs last name
    when parsing contact information from text or images.

    Problem:
    - Names can be in different formats: "John DOE", "DOE John", "John Doe"
    - Different cultures have different name order conventions
    - All-caps often indicates the family name

    Recognition rules to add in SKILL.md:
    1. Full uppercase word is likely the family name (e.g., "Jean DUPONT" -> lastname=DUPONT)
    2. In French context, family name often comes last
    3. In Asian contexts (e.g., Japanese business cards), family name often comes first
    4. When uncertain, express probability and ALWAYS ask for confirmation (US-00019)

    Heuristics with confidence levels:
    - If one word is ALL CAPS and others are Title Case: ALL CAPS = family name (HIGH confidence)
      Example: "Sebastien LAURENT" -> firstname=Sebastien, lastname=Laurent (95% certain)
    - If both words same case in French context: firstname lastname order (MEDIUM confidence)
      Example: "Jean Dupont" -> firstname=Jean, lastname=Dupont (80% certain)
    - If order is ambiguous or Asian name detected: (LOW confidence)
      Example: "Takeshi Yamamoto" -> could be either order (50% certain)
    - For more than 2 words, middle names go with first name unless specified

    Probabilistic reasoning:
    - HIGH confidence (>90%): Present the interpretation but still require confirmation
    - MEDIUM confidence (60-90%): Present interpretation with explanation of reasoning
    - LOW confidence (<60%): Present multiple possibilities and ask user to choose

    Example validation prompts by confidence:

    HIGH confidence:
    ```
    J'ai identifiÃ© : PrÃ©nom=Sebastien, Nom=LAURENT
    (Le nom en majuscules indique gÃ©nÃ©ralement le nom de famille)
    Est-ce correct ?
    ```

    MEDIUM confidence:
    ```
    J'ai identifiÃ© : PrÃ©nom=Jean, Nom=Dupont
    (Ordre franÃ§ais standard prÃ©nom-nom)
    Est-ce correct ?
    ```

    LOW confidence:
    ```
    Je ne suis pas certain de l'ordre du nom "Takeshi Yamamoto".
    Quel est le prÃ©nom et quel est le nom de famille ?
    - Option 1: PrÃ©nom=Takeshi, Nom=Yamamoto
    - Option 2: PrÃ©nom=Yamamoto, Nom=Takeshi
    ```

    SKILL.md updates:
    - Add "Name Recognition" section with these rules
    - Add confidence level explanations
    - Add examples of probabilistic reasoning
    - Emphasize ALWAYS confirming before creating contact (link to US-00019)

    Acceptance criteria:
    - SKILL.md documents name recognition heuristics
    - ALL CAPS rule is clearly explained with examples
    - Confidence levels documented (HIGH/MEDIUM/LOW)
    - Probabilistic reasoning examples provided
    - All cases require confirmation (mandatory per US-00019)
  tests:
  - SKILL.md contains "Name Recognition" section
  - SKILL.md explains ALL CAPS = family name heuristic
  - SKILL.md shows examples like "Sebastien LAURENT" -> lastname=Laurent
  - SKILL.md documents confidence levels (HIGH/MEDIUM/LOW)
  - SKILL.md shows probabilistic reasoning examples
  - SKILL.md emphasizes confirmation is ALWAYS required
  passes: true

- id: US-00019
  title: "google-contacts skill: Mandatory validation before contact creation"
  priority: 19
  description: |
    Update the skill to ALWAYS validate contact information with the user
    before executing the create command. This prevents errors from incorrect
    parsing or OCR mistakes.

    Current problem:
    - Skill might create contacts with wrong name order
    - Screenshot OCR might misread characters
    - User might not notice errors until contact is already created

    Solution - Mandatory validation workflow:
    1. Parse/extract contact information
    2. ALWAYS display extracted data in a clear format
    3. ALWAYS ask user to confirm or correct
    4. Only execute create command after explicit confirmation

    Validation prompt format:
    ```
    ðŸ“‹ Contact Ã  crÃ©er :
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    PrÃ©nom    : Jean
    Nom       : Dupont
    TÃ©lÃ©phone : +33 6 12 34 56 78 (mobile)
    Email     : jean@acme.com (work)
    Entreprise: Acme Corp
    Poste     : CTO

    Est-ce correct ? (oui/non/modifier)
    ```

    User responses:
    - "oui" / "yes" / "ok" / "c'est bon" -> proceed with creation
    - "non" / "no" -> cancel
    - "modifier" / "change" + corrections -> update and re-validate

    SKILL.md updates:
    - Make validation step MANDATORY (not optional)
    - Add validation prompt format
    - Document how to handle corrections
    - Remove any workflow that skips validation

    Acceptance criteria:
    - SKILL.md makes validation mandatory before any create
    - Validation prompt format is clearly defined
    - User can confirm, cancel, or modify
    - No contact created without explicit user confirmation
  tests:
  - SKILL.md marks validation as MANDATORY
  - SKILL.md contains validation prompt format
  - SKILL.md shows confirm/cancel/modify options
  - All create workflows include validation step
  - Screenshot workflow includes validation step
  - Natural language workflow includes validation step
  passes: true

- id: US-00020
  title: "google-contacts skill: Document delete and update workflows"
  priority: 20
  description: |
    Update SKILL.md to document the new delete and update commands
    once they are implemented (depends on US-00014, US-00015).

    Delete workflow:
    - Natural language: "Delete the contact for Jean Dupont"
    - First search for the contact
    - Show contact details and ask for confirmation
    - Execute delete command
    - Confirm deletion

    Update workflow:
    - Natural language: "Update Jean's phone number to 0698765432"
    - First search for the contact
    - Show current contact details
    - Show proposed changes
    - Ask for confirmation
    - Execute update command
    - Show updated contact

    SKILL.md sections to add:
    - "5. Supprimer un contact" / "Delete a contact"
    - "6. Modifier un contact" / "Update a contact"
    - Delete workflow with confirmation
    - Update workflow with validation
    - Natural language examples for both

    Safety considerations:
    - ALWAYS confirm before delete
    - ALWAYS show before/after for update
    - Provide undo guidance (re-create from memory for delete)

    Acceptance criteria:
    - SKILL.md documents delete command
    - SKILL.md documents update command
    - Both workflows include confirmation steps
    - Natural language examples provided
  tests:
  - SKILL.md contains delete section
  - SKILL.md contains update section
  - Delete workflow requires confirmation
  - Update workflow shows before/after
  - Natural language examples for delete
  - Natural language examples for update
  passes: true

- id: US-00021
  title: "google-contacts skill: Document multiple phones/emails support"
  priority: 21
  description: |
    Update SKILL.md to document support for multiple phones and emails
    once implemented (depends on US-00016, US-00017).

    Phone types documentation:
    - mobile: TÃ©lÃ©phone portable / Mobile phone
    - work: TÃ©lÃ©phone professionnel / Work phone
    - home: TÃ©lÃ©phone domicile / Home phone
    - main: TÃ©lÃ©phone principal / Main phone
    - other: Autre / Other

    Email types documentation:
    - work: Email professionnel / Work email
    - home: Email personnel / Home email
    - other: Autre / Other

    Update SKILL.md sections:
    - Create command: show multiple phone/email syntax
    - Update command: show add/remove phone/email syntax
    - Show command: demonstrate multi-phone/email display
    - Validation prompt: show multiple phones/emails format

    Natural language examples:
    - "CrÃ©e un contact avec deux numÃ©ros: mobile et travail"
    - "Ajoute son email personnel john@gmail.com"
    - "Change son numÃ©ro de travail"
    - "Remove his home phone"

    Acceptance criteria:
    - SKILL.md documents phone types
    - SKILL.md documents email types
    - Create examples show multiple phones/emails
    - Update examples show add/remove
    - Validation prompt shows all phones/emails
  tests:
  - SKILL.md lists all phone types
  - SKILL.md lists all email types
  - Create command examples with multiple phones
  - Create command examples with multiple emails
  - Update command examples with --add-phone
  - Update command examples with --add-email
  - Validation prompt format includes multiple entries
  passes: false

# =============================================================================
# DEPLOYMENT NOTE
# =============================================================================
# After implementing CLI changes, deploy the binary to the skill directory:
#   make install INSTALL_DIR=~/.claude/skills/google-contacts/scripts/
#
# The skill references the binary at:
#   ~/.claude/skills/google-contacts/scripts/google-contacts
#
# This is NOT a user story but a deployment task to be done after each
# CLI modification (US-00014 through US-00017).
